(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{108:function(t,e,n){"use strict";n.r(e);var c=n(2),r=n.n(c),i=n(68),a=n.n(i),s=n(118),o=n(119),d=n(121),j=n(117),l=n(49),u=n(73),b=n(34),O=(n(86),n(71)),h=n(12),f=n(43),p=n(113),x=n(54),v=n(69),w=n(50),y=n(70),m=n.n(y),g=(n(87),n(4));function C(t){var e=Object(c.useState)([]),n=Object(f.a)(e,2),r=n[0],i=n[1],a=function(t){return t.map((function(t){return function(t){for(var e={},n=0,c=Object.entries(t);n<c.length;n++){var r=Object(f.a)(c[n],2),i=r[0],a=r[1],s=i.indexOf("_");if(!(s<0)){var o=i.slice(0,s),d=i.slice(s+1);void 0===e[o]&&(e[o]={}),e[o][d]=a,delete t[i]}}return Object(w.a)(Object(w.a)({},e),t)}(Object(w.a)({},t))}))},s=t.mutation,o=Object(c.useCallback)(function(){var t=Object(v.a)(Object(x.a)().mark((function t(e){return Object(x.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s({variables:{data:e}});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[s]),d=r.length>0?Object.keys(r[0]):[],j=r.map((function(t,e){return Object(g.jsx)("tr",{children:d.map((function(n){return Object(g.jsx)("td",{children:t[n]},"".concat(e,"_").concat(n))}))},e)}));return Object(g.jsxs)("div",{className:"Uploader",children:[Object(g.jsxs)("div",{className:"controls",children:[Object(g.jsx)("div",{className:"tag",children:t.tag}),Object(g.jsx)("input",{type:"file",accept:".csv",onChange:function(t){try{var e=t.target.files[0];m.a.parse(e,{header:!0,dynamicTyping:!0,complete:function(t){t.data=t.data.filter((function(t){return t.ssn}));var e=a(t.data);i(t.data),o(e)}})}catch(n){console.error(n)}},size:"32px"})]}),Object(g.jsx)("table",{children:Object(g.jsxs)("tbody",{children:[Object(g.jsx)("tr",{children:d.map((function(t){return Object(g.jsx)("th",{children:t},t)}))}),j]})})]})}var k,N,L,P=n(35),E=n(120),$=Object(E.a)(k||(k=Object(P.a)(["\n  mutation insertPeople(\n    $data: [PersonInput!]!\n  ) {\n    insertPeople(\n      data: $data\n    ) \n  }\n"]))),K=Object(E.a)(N||(N=Object(P.a)(["\n    query statsCount(\n        $locationKeywords: [String!]!\n        $severity: Int\n    ) {\n        statsCount(\n            locationKeywords: $locationKeywords,\n            severity: $severity,\n        )\n    }\n"]))),S=Object(E.a)(L||(L=Object(P.a)(["\n    subscription {\n        people {\n            inserted {\n                severity\n                location {\n                    description\n                }\n            }\n            deleted {\n                severity\n                location {\n                    description\n                }\n            }\n        }\n    }\n\n"])));n(89);function F(){var t=Object(p.a)($),e=Object(f.a)(t,1)[0];return Object(g.jsx)("div",{id:"Upload",children:Object(g.jsx)("div",{id:"PeopleUploader",children:Object(g.jsx)(C,{tag:"People",mutation:e})})})}var I=n(78),T=n(122),U={watchList:["\u57fa\u9686\u5e02","\u81fa\u5317\u5e02","\u65b0\u5317\u5e02","\u6843\u5712\u5e02","\u65b0\u7af9\u5e02","\u65b0\u7af9\u7e23","\u82d7\u6817\u7e23","\u81fa\u4e2d\u5e02","\u5f70\u5316\u7e23","\u5357\u6295\u7e23","\u96f2\u6797\u7e23","\u5609\u7fa9\u5e02","\u5609\u7fa9\u7e23","\u81fa\u5357\u5e02","\u9ad8\u96c4\u5e02","\u5c4f\u6771\u7e23","\u5b9c\u862d\u7e23","\u82b1\u84ee\u7e23","\u81fa\u6771\u7e23","\u6f8e\u6e56\u7e23","\u91d1\u9580\u7e23","\u9023\u6c5f\u7e23"]};function q(t){var e=Object(T.a)(K,{variables:{locationKeywords:U.watchList,severity:1}}),n=e.data,r=e.subscribeToMore;return Object(c.useEffect)((function(){try{r({document:S,updateQuery:function(t,e){var n=e.subscriptionData,c=Object(I.a)(t.statsCount),r=n.data.people,i=r.inserted,a=r.deleted;return i.forEach((function(t){0!==t.severity&&U.watchList.forEach((function(e,n){t.location.description.includes(e)&&(c[n]+=1)}))})),a.forEach((function(t){0!==t.severity&&U.watchList.forEach((function(e,n){t.location.description.includes(e)&&(c[n]-=1)}))})),{statsCount:c}}})}catch(t){console.error(t)}}),[r]),Object(g.jsx)("table",{children:Object(g.jsxs)("tbody",{children:[Object(g.jsxs)("tr",{children:[Object(g.jsx)("th",{children:"Keyword"}),Object(g.jsx)("th",{children:"Count"})]}),U.watchList.map((function(t,e){return Object(g.jsxs)("tr",{children:[Object(g.jsx)("td",{children:t}),Object(g.jsx)("td",{id:"count-".concat(e),children:!n||!n.statsCount||n.statsCount[e]})]},t)}))]})})}n(90);function D(){return Object(g.jsx)("div",{className:"Stats",children:Object(g.jsx)(q,{})})}n(91);function B(){var t=function(){window.location="/"};return Object(g.jsxs)("div",{className:"Header",children:[Object(g.jsx)("div",{onClick:t,className:"slogan",children:"\u78ba\u8a3a\u500b\u6848\u8ffd\u8e64\u7cfb\u7d71"}),Object(g.jsxs)("div",{className:"control",children:[Object(g.jsx)("div",{className:"button",onClick:t,children:" \u7d71\u8a08\u8868 "}),Object(g.jsx)("div",{className:"button",onClick:function(){window.location="/upload"},children:" \u4e0a\u50b3 "})]})]})}var J=function(){return Object(g.jsxs)("div",{className:"App",children:[Object(g.jsx)(B,{}),Object(g.jsx)(O.a,{children:Object(g.jsxs)(h.c,{children:[Object(g.jsx)(h.a,{path:"/upload",children:Object(g.jsx)(F,{})}),Object(g.jsx)(h.a,{path:"/",children:Object(g.jsx)(D,{})})]})})]})},M=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,124)).then((function(e){var n=e.getCLS,c=e.getFID,r=e.getFCP,i=e.getLCP,a=e.getTTFB;n(t),c(t),r(t),i(t),a(t)}))},_=new URL("/graphql",window.location.href),z=new s.a({uri:_.href}),A=new u.a({uri:_.href.replace("http","ws"),options:{reconnect:!0}}),H=Object(l.b)((function(t){var e=t.query,n=Object(b.a)(e);return"OperationDefinition"===n.kind&&"subscription"===n.operation}),A,z),Q=new o.a({link:H,cache:(new d.a).restore({})});a.a.render(Object(g.jsx)(r.a.StrictMode,{children:Object(g.jsx)(j.a,{client:Q,children:Object(g.jsx)(J,{})})}),document.getElementById("root")),M()},86:function(t,e,n){},87:function(t,e,n){},89:function(t,e,n){},90:function(t,e,n){},91:function(t,e,n){}},[[108,1,2]]]);
//# sourceMappingURL=main.0cef7311.chunk.js.map